@version: 4.7
@include "scl.conf"

# ----------------------------------------------------------------
# SOURCE: Fichier d'alerte Snort
# ----------------------------------------------------------------
# Nous lisons le fichier "alert" qui se trouve dans le volume 'snort-logs'
# (qui correspond à /var/log/snort/alert dans le conteneur 'ids')
#
source s_snort_file {
    file("/snort-logs/alert"
         follow-freq(1)      
         flags(no-parse)     
    );
};

# ----------------------------------------------------------------
# DESTINATION: Console (pour le débogage)
# ----------------------------------------------------------------
# Envoie les logs directement à la sortie standard
# (visible avec 'docker-compose logs -f syslog')
#
destination d_stdout {
    file("/dev/stdout");
};

# ----------------------------------------------------------------
# RÈGLE DE LOG
# ----------------------------------------------------------------
# Connecte la source (fichier snort) à la destination (console)
#
log {
    source(s_snort_file);
    destination(d_stdout);
};

